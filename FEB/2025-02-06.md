# TIL Template

## 날짜: 2025-02-06

### 스크럼
- 학습 목표 : 능동적으로 공부하기

### 개념 정리

|  | 정의 | 비고 |
| --- | --- | --- |
| 동시성(Concurrency) | 여러 작업이 동시에 실행되는 것처럼 보이게 번갈아가며 실행되는 것 | 여러 작업이 동일한 CPU와 메모리를 공유하며 동작하며, 작업 실행 순서는 스케쥴러(Scheduler)에 의해 관리된다. |
| 병렬성(Parallelism) | 여러 작업이 실제로 동시에 실행되는 것 | 다중 코어 CPU 또는 다중 프로세서의 지원을 필요로 하며, 각 작업이 서로 간섭 없이 독립적으로 실행된다.<br>병렬 실행 이후에는 각 작업의 결과를 취합하여 최종적으로 전달되며, 병렬 처리 도중 오류가 발생하면 재시도하거나 각 프로세스 또는 스레드가 독립적으로 문제를 해결하여 작업이 계속 진행되도록 보장한다. |
| 스케쥴러(Scheduler) | 컴퓨터 자원을 적절히 분배하는 구성 요소 | 스케쥴러는 시스템에 얼마나 많은 작업을 실행할지, 메모리에 있는 작업 중 어떤 작업을 임시로 중단(스왑)할지, 실행 가능한 작업 중 다음에 CPU를 사용할 작업을 결정하고 자원 분배, 작업 전환, 완료 및 자원 해제 등을 진행한다.<br>스케쥴러는 CPU 이용률과 처리량을 최대화하고, 총 처리 시간, 대기 시간, 응답 시간을 최소화하기 위해 사용한다. |
| 컨텍스트 스위칭(Context Switching) | CPU가 현재 실행중인 작업(프로세스/스레드)의 상태(문맥)를 보관하고, 새로운 작업의 상태를 복구하여 실행을 전환하는 과정 | 문맥교환이 발생하면 커널은 과거 프로세스/스레드의 문맥을 PCB(Process Control Block)에 저장하고, 실행이 스케줄된 새로운 프로세스/스레드의 저장된 문맥을 복구한다.<br>작업 간 전환 시, 이전 작업의 상태(레지스터, 프로그램 카운터 등)를 저장하고, 새로운 작업의 상태를 복원하여 작업이 중단 없이 진행되도록 한다. |
| 스레드풀(Thread Pool) | 미리 일정 개수의 스레드를 만들어놓고 재사용하여 실행하는 기법 | 스레드 풀은 한 지점에 존재하는 스레드의 수를 제한하며, 기존 스레드로 요청을 처리하는 것이 스레드를 만들기 위해 기다리는 것보다 더 빠른 경우가 많다. |

### (선택) 비선점형 스케쥴링(Non-preemptive Scheduling)

실행 중인 작업(프로세스/스레드)을 중간에 강제로 멈추고, 다른 작업을 CPU 할당할 수 있는 스케쥴링 방식

- 대표적인 알고리즘으로 FCFS(First-Come First-Served, 선입선출), SJF(Shortest Job First, 최단 작업 우선) 등이 있다.
    - SJF 알고리즘은 비선점 알고리즘, 선점 알고리즘 둘 다 가능하지만 보통 preemptive SJF를 SRTF라고 한다.

### (선택) 선점형 스케쥴링(preemptive Scheduling)

CPU를 할당받은 작업(프로세스/스레드)의 실행이 완료될 때까지 다른 작업이 CPU를 빼앗을 수 없는 스케쥴링 방식

- 대표적인 알고리즘으로 SRTF(Shortest Remaining Time First, 가장 짧은 남은 시간 우선), RR(Round-Robin, 라운드 로빈) 등이 있다.
    - RR(라운드 로빈)을 Preemptive FCFS라고도 한다.

### 라운드 로빈 스케쥴링(Round-Robin Scheduling)

모든 작업(프로세스/스레드)가 일정한 시간(Time Quantum / Time Slice)동안 CPU를 사용하고, 시간이 초과되면 선점되어 대기열(ReadyQueue)의 끝으로 이동하는 선점형(preemptive) 스케줄링 기법이다.

RR 스케줄링의 성능은 Time Quantum(q)의 크기에 크게 영향을 받는다.

- q가 너무 크면 FCFS와 동일해지고, q가 너무 작으면 컨텍스트 스위칭(Context Switching)이 너무 많이 발생한다.
    - 경험적인 규칙 (Rule of Thumb): 전체 CPU 버스트의 80%는 q보다 짧아야 함

### (선택) 콘보이 현상(Convoy effect)

실행시간이 긴 작업(프로세스/스레드)이 CPU를 점유하면서 짧은 작업들이 CPU를 사용하지 못하고 대기하는 현상으로, 스케쥴러가 FCFS 알고리즘을 사용할 경우에 발생한다.

### (추가) 기아 현상(Starvation)

실행시간이 짧은 작업을 우선적으로 처리하려다 긴 작업을 영원히 처리하지 못하는 현상으로, 우선순위 기반(Priority-Based) 알고리즘을 사용할 경우에 발생할 수 있다.

### (선택) 암달의 법칙(Amdahl's Law)

직렬(Serial) 및 병렬(Parallel) 구성 요소를 모두 갖춘 애플리케이션에 컴퓨팅 코어를 추가하여 얻을 수 있는 잠재적 성능 향상을 식별하는 공식

만약 S가 N개의 CPU를 가진 시스템에서 직렬로 수행되어야 하는 애플리케이션의 일부라면, 공식은 다음과 같이 나타난다: speedup ≤ 1 / (S + (1 - S) / N)

N이 무한대에 가까워질수록 speedup은 1 / S에 가까워지며, 이는 병렬로 실행할 수 없는 부분이 많으면 CPU 개수를 늘려도 속도 향상 효과가 제한된다는 것을 의미한다.

### (선택) c10k 문제

동시 사용자 1만명(Concurrent 10K users)이 접속하는 서버를 구현하는 문제

1999년 Dan Kegel이라는 개발자가 제기한 문제로, 시대가 지나면서 컴퓨터 하드웨어만 발전하는 것이 아니라, 사용자의 숫자도 늘어나며 문제의 규모는 점점 커졌다.

### 동시성과 병렬성의 차이를 설명하시오

동시성은 **하나의 CPU**에서 여러 작업(프로세스/스레드)이 **동시에 실행되는 것처럼 보이게** 하는 개념으로, 하드웨어와 무관하게 구현 가능하다.

병렬성은 **여러 CPU** 또는 **다중 프로세서**를 사용하여 여러 작업을 **물리적으로 동시에 실행**하는 개념으로, 동시성과 달리 **작업이 실제로 동시에 실행**되며, 이를 위한 **하드웨어 지원**이 필수적이다.

### 멀티 스레드 환경에서의 동시성과 병렬성을 설명하시오

**동시성**은 싱글 코어에서 멀티 스레드를 동작 시키는 방식으로,
여러 개의 스레드가 '**번갈아가면서**' 실행된다.

**병렬성**은 멀티 코어에서 멀티 스레드를 동작시키는 방식으로,
한 개 이상의 스레드를 포함하는 각 코어들이 '**동시에**' 실행된다.

### 컨텍스트 스위칭이 발생할 때 생기는 부정적인 영향을 설명하시오

과도한 컨텍스트 스위칭은 CPU의 작업 전환에 많은 시간을 소비하게 하며, 이는 결국 시스템의 처리량을 감소시킨다.

이러한 컨텍스트 스위칭의 영향을 최소화하기 위해 운영 체제의 스케줄링 알고리즘을 이해하고 이에 맞는 프로그램 설계가 중요하다. 예를 들어, 시간을 많이 소비하는 작업과 짧은 작업을 적절히 배치하여 컨텍스트 스위칭의 오버헤드를 줄일 수 있다.

또한 코드 최적화를 통해 불필요한 작업 전환을 줄이고, 공유 자원의 접근을 최소화하는 등의 방법으로 컨텍스트 스위칭의 비용을 줄일 수 있다.

### 스레드풀을 사용하는 이유와 장단점을 설명하시오

필요 이상으로 많은 스레드를 생성하면 컨텍스트 스위칭이 빈번하게 발생할 수 있으므로, 컨텍스트 스위칭의 영향을 최소화하기 위한 방법 중 하나는 스레드나 프로세스의 개수를 적절히 관리하는 것이다.

따라서 스레드 풀을 사용하는 등의 방법으로 스레드 생성과 관리를 최적화할 필요가 있다.

- 스레드 풀의 장점
    1. 스레드 생성과 소멸에 드는 비용을 줄일 수 있다.
    2. 스레드의 수를 제한하여 시스템 자원을 효율적으로 사용할 수 있다.
    3. 응답 시간이 빨라진다.
- 스레드 풀의 단점
    1. 스레드 풀의 크기를 잘못 설정하면 성능이 저하될 수 있다.
        - 스레드가 부족하면 작업이 지연되고,
        - 스레드가 과도하게 생성되면 시스템 자원이 낭비된다.
    2. 스레드 풀을 잘못 사용하면 데드락(두 개 이상의 스레드가 서로의 자원을 기다리며 무한 대기 상태에 빠지는 현상)이 발생할 수 있다.

### (선택) 프로세스 스케쥴링과 스레드 스케쥴링의 차이를 설명하시오

프로세스 스케줄링은 운영체제가 프로세스들의 CPU 시간을 어떻게 분배할지 결정하는 과정이고,

스레드 스케줄링은 운영체제가 같은 프로세스 내의 스레드들 사이에서 CPU 시간을 어떻게 분배할지 결정하는 과정이다.

### 오늘의 회고
이번엔 면접같이 질문을 받는 상황에서 어떻게 대답할 것인가를 고민해 보며 어떻게 하면 듣는 사람이 편하게 납득할 수 있을지를 생각하며 질문들에 대해 최대한 간단하게 정리해 봤다. 운영체제 수업 때 배웠던 내용을 복습한다는 느낌으로 편하게 강의를 들었는데도 이렇게 개념 정리에 오래 걸린 것을 보면 더 고민을 많이 하며 개념들에 다가가야 할 것 같다.

### 참고 자료 및 링크
- [Operating System Concepts, 10/E](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf)
- [자바의 스레드와 스레드 풀 이해하기](https://f-lab.kr/insight/understanding-java-threads-and-thread-pools-20240701)
- [스레드 스케줄링](https://wikidocs.net/232057)
- [고전 돌아보기, C10K 문제 (C10K Problem)](https://oliveyoung.tech/2023-10-02/c10-problem/)
- [컨텍스트 스위칭과 그 영향력 이해하기](https://f-lab.kr/insight/understanding-context-switching)
